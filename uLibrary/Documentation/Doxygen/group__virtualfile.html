<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Virtual Files</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.2 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul>
</div>
<h1>Virtual Files</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Modules</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile__io.html">I/O routines</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile__sources.html">Virtual file sources</a></td></tr>

<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e___s_o_u_r_c_e.html">VIRTUAL_FILE_SOURCE</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_u_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">UL_VIRTUALFILENAME</a></td></tr>

<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#g2e7ccec76b09ff3f2d925f60050b5fcb">VF_OPEN_MODES</a> { <a class="el" href="group__virtualfile.html#gg2e7ccec76b09ff3f2d925f60050b5fcb2e020641b63339f59df52a0c2d4d3a02">VF_O_READ</a>, 
<a class="el" href="group__virtualfile.html#gg2e7ccec76b09ff3f2d925f60050b5fcbdf9ddacf8fe982cb181d2937fd35f4ec">VF_O_READWRITE</a>, 
<a class="el" href="group__virtualfile.html#gg2e7ccec76b09ff3f2d925f60050b5fcbb0b2f6caaeec6ee61c08f33a74c7c589">VF_O_WRITE</a>
 }</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#ga547c677ff6bf88640719a647cd02584">VirtualFileInit</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#g07077224dae9a3b273e364c1167f7908">VirtualFileOpen</a> (void *param1, int param2, int type, int mode)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#g22020f913566390f6578dfccefdf7219">VirtualFileClose</a> (<a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *f)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#g0181b5d9f972777de7a959a47403ffb5">VirtualFileRegisterSource</a> (<a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e___s_o_u_r_c_e.html">VIRTUAL_FILE_SOURCE</a> *vfs)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#g7b63d625c24b88e4e0abc4b97bfea6d8">ulSetVirtualFilenameList</a> (<a class="el" href="struct_u_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">UL_VIRTUALFILENAME</a> *vfl, int numberOfEntries)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="struct_u_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">UL_VIRTUALFILENAME</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#gefd188ccf07860cc3f39a5d08beb2de8">ulFindFileInVirtualFilenameList</a> (const char *fname, int type)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__virtualfile.html#g84832a4145a759bcfb68472f46570ff2">ulReadEntireFileToMemory</a> (<a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *f, int *size)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Virtual File support for µLibrary. This API is meant to be an universal mean to manipulate every file source possible as you can define your own. <hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="g2e7ccec76b09ff3f2d925f60050b5fcb"></a><!-- doxytag: member="VirtualFile.h::VF_OPEN_MODES" ref="g2e7ccec76b09ff3f2d925f60050b5fcb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__virtualfile.html#g2e7ccec76b09ff3f2d925f60050b5fcb">VF_OPEN_MODES</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Enumeration describing the available file open modes. Please note that some sources do not support some modes like READWRITE or WRITE, in this case they'll fail when an attempt to open a file in one of these modes is made. The resulting file returned by VirtualFileOpen will be NULL. <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gg2e7ccec76b09ff3f2d925f60050b5fcb2e020641b63339f59df52a0c2d4d3a02"></a><!-- doxytag: member="VF_O_READ" ref="gg2e7ccec76b09ff3f2d925f60050b5fcb2e020641b63339f59df52a0c2d4d3a02" args="" -->VF_O_READ</em>&nbsp;</td><td>
Read only. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2e7ccec76b09ff3f2d925f60050b5fcbdf9ddacf8fe982cb181d2937fd35f4ec"></a><!-- doxytag: member="VF_O_READWRITE" ref="gg2e7ccec76b09ff3f2d925f60050b5fcbdf9ddacf8fe982cb181d2937fd35f4ec" args="" -->VF_O_READWRITE</em>&nbsp;</td><td>
Read &amp; Write. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg2e7ccec76b09ff3f2d925f60050b5fcbb0b2f6caaeec6ee61c08f33a74c7c589"></a><!-- doxytag: member="VF_O_WRITE" ref="gg2e7ccec76b09ff3f2d925f60050b5fcbb0b2f6caaeec6ee61c08f33a74c7c589" args="" -->VF_O_WRITE</em>&nbsp;</td><td>
Write only. </td></tr>
</table>
</dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="ga547c677ff6bf88640719a647cd02584"></a><!-- doxytag: member="VirtualFile.h::VirtualFileInit" ref="ga547c677ff6bf88640719a647cd02584" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VirtualFileInit           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initializes the virtual filesystem. Done by default by µLibrary, so there is no need to call it by yourself. 
</div>
</div><p>
<a class="anchor" name="g07077224dae9a3b273e364c1167f7908"></a><!-- doxytag: member="VirtualFile.h::VirtualFileOpen" ref="g07077224dae9a3b273e364c1167f7908" args="(void *param1, int param2, int type, int mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a>* VirtualFileOpen           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>param1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>param2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Open a new file. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>param1</em>&nbsp;</td><td>Depends on the file source. By default:<ul>
<li>VF_MEMORY: pointer to your data</li><li>VF_GBFS, VF_FILE: pointer to a string containing the file name </li></ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param2</em>&nbsp;</td><td>Depends on the file source. By default:<ul>
<li>VF_MEMORY: total size of the memory block</li><li>VF_GBFS, VF_FILE: 0 </li></ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>File type. By default, can be:<ul>
<li>VF_MEMORY: read/write from a memory block</li><li>VF_FILE: read from standard stdio routines (libfat). Requires a prior call to ulInitLibFat.</li><li>VF_GBFS: read from GBFS. Requires a prior call to ulInitGBFS. </li></ul>
</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>One of VF_OPEN_MODES. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="g22020f913566390f6578dfccefdf7219"></a><!-- doxytag: member="VirtualFile.h::VirtualFileClose" ref="g22020f913566390f6578dfccefdf7219" args="(VIRTUAL_FILE *f)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int VirtualFileClose           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Closes an open file. 
</div>
</div><p>
<a class="anchor" name="g0181b5d9f972777de7a959a47403ffb5"></a><!-- doxytag: member="VirtualFile.h::VirtualFileRegisterSource" ref="g0181b5d9f972777de7a959a47403ffb5" args="(VIRTUAL_FILE_SOURCE *vfs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int VirtualFileRegisterSource           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e___s_o_u_r_c_e.html">VIRTUAL_FILE_SOURCE</a> *&nbsp;</td>
          <td class="paramname"> <em>vfs</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a new file source to the virtual file system.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>vfs</em>&nbsp;</td><td>Must be a pointer to a valid <a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e___s_o_u_r_c_e.html">VIRTUAL_FILE_SOURCE</a> interface containing all your functions for handling the file source. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Returns the identifier of your source or -1 if it has failed. You can then use this ID as a file type (parameter for VirtualFileOpen). </dd></dl>

</div>
</div><p>
<a class="anchor" name="g7b63d625c24b88e4e0abc4b97bfea6d8"></a><!-- doxytag: member="VirtualFile.h::ulSetVirtualFilenameList" ref="g7b63d625c24b88e4e0abc4b97bfea6d8" args="(UL_VIRTUALFILENAME *vfl, int numberOfEntries)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ulSetVirtualFilenameList           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_u_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">UL_VIRTUALFILENAME</a> *&nbsp;</td>
          <td class="paramname"> <em>vfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>numberOfEntries</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Registers a file list for RAM based devices (such as VF_MEMORY). This way you can make a virtual file driver for files in RAM and then easily switch from a libFat, GBFS or RAM system, only by speficying file names when loading. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>vfl</em>&nbsp;</td><td>List of files (each file is a <a class="el" href="struct_u_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">UL_VIRTUALFILENAME</a> item) </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="gefd188ccf07860cc3f39a5d08beb2de8"></a><!-- doxytag: member="VirtualFile.h::ulFindFileInVirtualFilenameList" ref="gefd188ccf07860cc3f39a5d08beb2de8" args="(const char *fname, int type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_u_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">UL_VIRTUALFILENAME</a>* ulFindFileInVirtualFilenameList           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Call this function in your virtual file source OPEN handler, if it's a RAM based device and param2 == 0 (means null size, impossible). It will return a <a class="el" href="struct_u_l___v_i_r_t_u_a_l_f_i_l_e_n_a_m_e.html">UL_VIRTUALFILENAME</a> where you can get a pointer to the data and their size. Note that the return value can be NULL if the file has not been found or an error occured (e.g. fname is NULL). 
</div>
</div><p>
<a class="anchor" name="g84832a4145a759bcfb68472f46570ff2"></a><!-- doxytag: member="VirtualFile.h::ulReadEntireFileToMemory" ref="g84832a4145a759bcfb68472f46570ff2" args="(VIRTUAL_FILE *f, int *size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* ulReadEntireFileToMemory           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_v_i_r_t_u_a_l___f_i_l_e.html">VIRTUAL_FILE</a> *&nbsp;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reads an entire file to memory and returns a pointer to the memory block. The block memory usage is stepped by 4 kB, so even a 1 kB file will take 16 kB, so this function is not recommended for opening a lot of small files. The bloc must be freed (using free) once you've finished with it! <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>f</em>&nbsp;</td><td>Pointer to an open virtual file. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Pointer to an integer that will contain the number of bytes read from the file. </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Jul 14 23:39:33 2007 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.2 </small></address>
</body>
</html>
